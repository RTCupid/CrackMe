Turbo Assembler	 Version 4.1	    03/02/25 10:54:27	    Page 1
crackme.asm



      1				     ;------------------------------------------------------------------------------
      2				     ;			      Asm Task to Crack	somebody
      3				     ;			       (c) 2025	Muratov	Artyom
      4				     ;------------------------------------------------------------------------------
      5
      6	0000			     .model  tiny
      7	0000			     .code
      8				     org     100h
      9
     10	0100			     Start:
     11	0100  BA 0130r				     lea  dx, AskPassword	     ; dx = request a password
     12	0103  E8 0023				     call PutString		     ; output string to	consol
     13
     14	0106  E8 000B				     call ReadPassword		     ; read password from
     15										     ; stdin to	check it
     16										     ;-----------------------
     17	0109  BA 0145r				     lea  dx, InputPassword	     ;	dx = string to put  |
     18										     ;-----------------------
     19	010C  E8 001A				     call PutString		     ; output string to	consol
     20
     21	010F  B8 4C00				     mov  ax, 4c00h		     ; DOS Fn 4ch = exit (al)
     22	0112  CD 21				     int  21h
     23
     24				     ;------------------------------------------------------------------------------
     25				     ; ReadPassword  func to read password from	stdin to buffer
     26				     ; Entry:	     None
     27				     ; Exit:	     InputPassword - buffer from stdin
     28				     ; Destroy:	     cx, ax, di,
     29				     ;------------------------------------------------------------------------------
     30	0114			     ReadPassword    proc
     31	0114  B9 000B				     mov  cx, 11		     ; cx = number of symbols
     32										     ; in password
     33	0117  BF 0145r				     mov  di, offset InputPassword   ; offset
     34	011A  B4 07				     mov  ah, 07h		     ; DOS Fn 07H: No echo
     35										     ; unfiltered console input
     36	011C			     NewChar:
     37	011C  CD 21				     int  21h			     ; call Fn 07H
     38										     ; al = input symbol
     39	011E  2E: 88 05				     mov  cs:[di], al		     ; write to	buffer InputPassword
     40	0121  47				     inc  di			     ; di++
     41
     42	0122  E2 F8				     loop NewChar		     ; while (--cx) goto NewChar
     43	0124  2E: C6 05	24			     mov  byte ptr cs:[di], '$'	     ; write to	InputPassword
     44										     ; end symbol '$'
     45	0128  C3				     ret
     46	0129			     ReadPassword    endp
     47				     ;------------------------------------------------------------------------------
     48				     ;------------------------------------------------------------------------------
     49				     ; PutString  Func to make string of frame
     50				     ; Entry:	     dx	    - offset  array of symbol for string
     51				     ; Exit:	     None
     52				     ; Destroy:	     di, si, al
     53				     ;------------------------------------------------------------------------------
     54	0129			     PutString	     proc
     55	0129  B4 09				     mov  ah, 09h		     ; DOS Fn 09h = puts(dx)
     56
     57	012B  CD 21				     int  21h			     ; call puts(dx)
Turbo Assembler	 Version 4.1	    03/02/25 10:54:27	    Page 2
crackme.asm



     58
     59	012D  C3				     ret
     60	012E			     PutString	     endp
     61
     62				     ;------------------------------------------------------------------------------
     63				     ; HashCounter   func to count hash	of password
     64				     ; Entry:	     si	= ptr to string	of password
     65				     ; Exit:	     ax	= hash of password
     66				     ; Destroy:	     si, ax,
     67				     ;------------------------------------------------------------------------------
     68	012E			     HashCounter     proc
     69
     70
     71
     72
     73	012E  C3				     ret
     74	012F			     HashCounter     endp
     75
     76				     ;------------------------------------------------------------------------------
     77	012F  0B		     AdminPasswordLen db 11
     78
     79	0130  45 6E 74 65 72 20	74+  AskPassword     db	 "Enter	the password: $"
     80	      68 65 20 70 61 73	73+
     81	      77 6F 72 64 3A 20	24
     82
     83	0145  0C*(73)		     InputPassword   db	 12 dup	('s')
     84
     85	0151  50 4F 4C 54 4F 52	41+  AdminPassword   db	 "POLTORASHKA"
     86	      53 48 4B 41
     87
     88				     End	     Start
Turbo Assembler	 Version 4.1	    03/02/25 10:54:27	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/02/25"
??FILENAME			  Text	 "crackme "
??TIME				  Text	 "10:54:27"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 CRACKME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ADMINPASSWORD			  Byte	 DGROUP:0151
ADMINPASSWORDLEN		  Byte	 DGROUP:012F
ASKPASSWORD			  Byte	 DGROUP:0130
HASHCOUNTER			  Near	 DGROUP:012E
INPUTPASSWORD			  Byte	 DGROUP:0145
NEWCHAR				  Near	 DGROUP:011C
PUTSTRING			  Near	 DGROUP:0129
READPASSWORD			  Near	 DGROUP:0114
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  015C Word	  Public  CODE
